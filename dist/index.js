var To=Object.create;var U=Object.defineProperty,Ao=Object.defineProperties,jo=Object.getOwnPropertyDescriptor,qo=Object.getOwnPropertyDescriptors,Io=Object.getOwnPropertyNames,Ye=Object.getOwnPropertySymbols,Lo=Object.getPrototypeOf,Je=Object.prototype.hasOwnProperty,Mo=Object.prototype.propertyIsEnumerable;var Ne=(t,e,r)=>e in t?U(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,m=(t,e)=>{for(var r in e||(e={}))Je.call(e,r)&&Ne(t,r,e[r]);if(Ye)for(var r of Ye(e))Mo.call(e,r)&&Ne(t,r,e[r]);return t},D=(t,e)=>Ao(t,qo(e)),Bo=t=>U(t,"__esModule",{value:!0});var f=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),W=(t,e)=>{for(var r in e)U(t,r,{get:e[r],enumerable:!0})},Eo=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Io(e))!Je.call(t,o)&&o!=="default"&&U(t,o,{get:()=>e[o],enumerable:!(r=jo(e,o))||r.enumerable});return t},oe=t=>Eo(Bo(U(t!=null?To(Lo(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var d=(t,e,r)=>(Ne(t,typeof e!="symbol"?e+"":e,r),r);var ae=f((Al,st)=>{function Yo(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}st.exports=Yo});var Ae=f((jl,at)=>{var Jo=ae(),lt=Object.create,Xo=function(){function t(){}return function(e){if(!Jo(e))return{};if(lt)return lt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();at.exports=Xo});var de=f((ql,dt)=>{function Vo(){}dt.exports=Vo});var ce=f((Il,pt)=>{var Qo=Ae(),Zo=de();function pe(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}pe.prototype=Qo(Zo.prototype);pe.prototype.constructor=pe;pt.exports=pe});var ft=f((Ll,ct)=>{function ei(t,e){for(var r=-1,o=e.length,i=t.length;++r<o;)t[i+r]=e[r];return t}ct.exports=ei});var ut=f((Ml,ht)=>{var ti=typeof global=="object"&&global&&global.Object===Object&&global;ht.exports=ti});var fe=f((Bl,mt)=>{var ri=ut(),oi=typeof self=="object"&&self&&self.Object===Object&&self,ii=ri||oi||Function("return this")();mt.exports=ii});var he=f((El,gt)=>{var ni=fe(),si=ni.Symbol;gt.exports=si});var yt=f((Kl,wt)=>{var Ft=he(),bt=Object.prototype,li=bt.hasOwnProperty,ai=bt.toString,X=Ft?Ft.toStringTag:void 0;function di(t){var e=li.call(t,X),r=t[X];try{t[X]=void 0;var o=!0}catch(n){}var i=ai.call(t);return o&&(e?t[X]=r:delete t[X]),i}wt.exports=di});var Dt=f((Wl,vt)=>{var pi=Object.prototype,ci=pi.toString;function fi(t){return ci.call(t)}vt.exports=fi});var je=f((zl,Pt)=>{var Ct=he(),hi=yt(),ui=Dt(),mi="[object Null]",gi="[object Undefined]",St=Ct?Ct.toStringTag:void 0;function Fi(t){return t==null?t===void 0?gi:mi:St&&St in Object(t)?hi(t):ui(t)}Pt.exports=Fi});var ue=f((Rl,xt)=>{function bi(t){return t!=null&&typeof t=="object"}xt.exports=bi});var _t=f((Gl,Nt)=>{var wi=je(),yi=ue(),vi="[object Arguments]";function Di(t){return yi(t)&&wi(t)==vi}Nt.exports=Di});var At=f(($l,Tt)=>{var kt=_t(),Ci=ue(),Ot=Object.prototype,Si=Ot.hasOwnProperty,Pi=Ot.propertyIsEnumerable,xi=kt(function(){return arguments}())?kt:function(t){return Ci(t)&&Si.call(t,"callee")&&!Pi.call(t,"callee")};Tt.exports=xi});var me=f((Hl,jt)=>{var Ni=Array.isArray;jt.exports=Ni});var Mt=f((Ul,Lt)=>{var qt=he(),_i=At(),ki=me(),It=qt?qt.isConcatSpreadable:void 0;function Oi(t){return ki(t)||_i(t)||!!(It&&t&&t[It])}Lt.exports=Oi});var Kt=f((Yl,Et)=>{var Ti=ft(),Ai=Mt();function Bt(t,e,r,o,i){var n=-1,s=t.length;for(r||(r=Ai),i||(i=[]);++n<s;){var l=t[n];e>0&&r(l)?e>1?Bt(l,e-1,r,o,i):Ti(i,l):o||(i[i.length]=l)}return i}Et.exports=Bt});var zt=f((Jl,Wt)=>{var ji=Kt();function qi(t){var e=t==null?0:t.length;return e?ji(t,1):[]}Wt.exports=qi});var Gt=f((Xl,Rt)=>{function Ii(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}Rt.exports=Ii});var Ut=f((Vl,Ht)=>{var Li=Gt(),$t=Math.max;function Mi(t,e,r){return e=$t(e===void 0?t.length-1:e,0),function(){for(var o=arguments,i=-1,n=$t(o.length-e,0),s=Array(n);++i<n;)s[i]=o[e+i];i=-1;for(var l=Array(e+1);++i<e;)l[i]=o[i];return l[e]=r(s),Li(t,this,l)}}Ht.exports=Mi});var Jt=f((Ql,Yt)=>{function Bi(t){return function(){return t}}Yt.exports=Bi});var Vt=f((Zl,Xt)=>{var Ei=je(),Ki=ae(),Wi="[object AsyncFunction]",zi="[object Function]",Ri="[object GeneratorFunction]",Gi="[object Proxy]";function $i(t){if(!Ki(t))return!1;var e=Ei(t);return e==zi||e==Ri||e==Wi||e==Gi}Xt.exports=$i});var Zt=f((ea,Qt)=>{var Hi=fe(),Ui=Hi["__core-js_shared__"];Qt.exports=Ui});var rr=f((ta,tr)=>{var qe=Zt(),er=function(){var t=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Yi(t){return!!er&&er in t}tr.exports=Yi});var ir=f((ra,or)=>{var Ji=Function.prototype,Xi=Ji.toString;function Vi(t){if(t!=null){try{return Xi.call(t)}catch(e){}try{return t+""}catch(e){}}return""}or.exports=Vi});var sr=f((oa,nr)=>{var Qi=Vt(),Zi=rr(),en=ae(),tn=ir(),rn=/[\\^$.*+?()[\]{}|]/g,on=/^\[object .+?Constructor\]$/,nn=Function.prototype,sn=Object.prototype,ln=nn.toString,an=sn.hasOwnProperty,dn=RegExp("^"+ln.call(an).replace(rn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function pn(t){if(!en(t)||Zi(t))return!1;var e=Qi(t)?dn:on;return e.test(tn(t))}nr.exports=pn});var ar=f((ia,lr)=>{function cn(t,e){return t==null?void 0:t[e]}lr.exports=cn});var Ie=f((na,dr)=>{var fn=sr(),hn=ar();function un(t,e){var r=hn(t,e);return fn(r)?r:void 0}dr.exports=un});var cr=f((sa,pr)=>{var mn=Ie(),gn=function(){try{var t=mn(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();pr.exports=gn});var hr=f((la,fr)=>{function Fn(t){return t}fr.exports=Fn});var gr=f((aa,mr)=>{var bn=Jt(),ur=cr(),wn=hr(),yn=ur?function(t,e){return ur(t,"toString",{configurable:!0,enumerable:!1,value:bn(e),writable:!0})}:wn;mr.exports=yn});var br=f((da,Fr)=>{var vn=800,Dn=16,Cn=Date.now;function Sn(t){var e=0,r=0;return function(){var o=Cn(),i=Dn-(o-r);if(r=o,i>0){if(++e>=vn)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}Fr.exports=Sn});var yr=f((pa,wr)=>{var Pn=gr(),xn=br(),Nn=xn(Pn);wr.exports=Nn});var Dr=f((ca,vr)=>{var _n=zt(),kn=Ut(),On=yr();function Tn(t){return On(kn(t,void 0,_n),t+"")}vr.exports=Tn});var Sr=f((fa,Cr)=>{var An=Ie(),jn=fe(),qn=An(jn,"WeakMap");Cr.exports=qn});var Nr=f((ha,xr)=>{var Pr=Sr(),In=Pr&&new Pr;xr.exports=In});var kr=f((ua,_r)=>{function Ln(){}_r.exports=Ln});var Le=f((ma,Tr)=>{var Or=Nr(),Mn=kr(),Bn=Or?function(t){return Or.get(t)}:Mn;Tr.exports=Bn});var jr=f((ga,Ar)=>{var En={};Ar.exports=En});var Me=f((Fa,Ir)=>{var qr=jr(),Kn=Object.prototype,Wn=Kn.hasOwnProperty;function zn(t){for(var e=t.name+"",r=qr[e],o=Wn.call(qr,e)?r.length:0;o--;){var i=r[o],n=i.func;if(n==null||n==t)return i.name}return e}Ir.exports=zn});var Fe=f((ba,Lr)=>{var Rn=Ae(),Gn=de(),$n=4294967295;function ge(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=$n,this.__views__=[]}ge.prototype=Rn(Gn.prototype);ge.prototype.constructor=ge;Lr.exports=ge});var Br=f((wa,Mr)=>{function Hn(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}Mr.exports=Hn});var Kr=f((ya,Er)=>{var Un=Fe(),Yn=ce(),Jn=Br();function Xn(t){if(t instanceof Un)return t.clone();var e=new Yn(t.__wrapped__,t.__chain__);return e.__actions__=Jn(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}Er.exports=Xn});var Rr=f((va,zr)=>{var Vn=Fe(),Wr=ce(),Qn=de(),Zn=me(),es=ue(),ts=Kr(),rs=Object.prototype,os=rs.hasOwnProperty;function be(t){if(es(t)&&!Zn(t)&&!(t instanceof Vn)){if(t instanceof Wr)return t;if(os.call(t,"__wrapped__"))return ts(t)}return new Wr(t)}be.prototype=Qn.prototype;be.prototype.constructor=be;zr.exports=be});var $r=f((Da,Gr)=>{var is=Fe(),ns=Le(),ss=Me(),ls=Rr();function as(t){var e=ss(t),r=ls[e];if(typeof r!="function"||!(e in is.prototype))return!1;if(t===r)return!0;var o=ns(r);return!!o&&t===o[0]}Gr.exports=as});var Jr=f((Ca,Yr)=>{var Hr=ce(),ds=Dr(),ps=Le(),Be=Me(),cs=me(),Ur=$r(),fs="Expected a function",hs=8,us=32,ms=128,gs=256;function Fs(t){return ds(function(e){var r=e.length,o=r,i=Hr.prototype.thru;for(t&&e.reverse();o--;){var n=e[o];if(typeof n!="function")throw new TypeError(fs);if(i&&!s&&Be(n)=="wrapper")var s=new Hr([],!0)}for(o=s?o:r;++o<r;){n=e[o];var l=Be(n),p=l=="wrapper"?ps(n):void 0;p&&Ur(p[0])&&p[1]==(ms|hs|us|gs)&&!p[4].length&&p[9]==1?s=s[Be(p[0])].apply(s,p[3]):s=n.length==1&&Ur(n)?s[l]():s.thru(n)}return function(){var u=arguments,c=u[0];if(s&&u.length==1&&cs(c))return s.plant(c).value();for(var A=0,T=r?e[A].apply(this,u):c;++A<r;)T=e[A].call(this,T);return T}})}Yr.exports=Fs});var V=f((Sa,Xr)=>{var bs=Jr(),ws=bs();Xr.exports=ws});import a from"prop-types";import h,{Component as ol}from"react";import{DndProvider as il}from"react-dnd";import{HTML5Backend as nl}from"react-dnd-html5-backend";var Xe={};W(Xe,{DefaultDetail:()=>ie});import $ from"prop-types";import z from"react";var _e=class extends z.Component{constructor(){super(...arguments);d(this,"handleCloseClick",e=>{e&&e.preventDefault(),this.props.close()})}render(){let e=this.props.file.key.split("/");return e=e.length?e[e.length-1]:"",z.createElement("div",null,z.createElement("h2",null,"Item Detail"),z.createElement("dl",null,z.createElement("dt",null,"Key"),z.createElement("dd",null,this.props.file.key),z.createElement("dt",null,"Name"),z.createElement("dd",null,e)),z.createElement("a",{href:"#",onClick:this.handleCloseClick},"Close"))}};d(_e,"propTypes",{file:$.shape({key:$.string.isRequired,name:$.string.isRequired,extension:$.string.isRequired,url:$.string}).isRequired,close:$.func});var ie=_e;var Ze={};W(Ze,{DefaultFilter:()=>ne});import Ve from"prop-types";import Qe from"react";var ke=class extends Qe.Component{constructor(){super(...arguments);d(this,"handleFilterChange",e=>{let r=e.target.value;this.props.updateFilter(r)})}render(){return Qe.createElement("input",{type:"search",placeholder:"Filter files",value:this.props.value,onChange:this.handleFilterChange})}};d(ke,"propTypes",{value:Ve.string.isRequired,updateFilter:Ve.func});var ne=ke;var nt={};W(nt,{TableHeader:()=>le});import B from"prop-types";import y from"react";import tt from"classnames";import{DropTarget as rt}from"react-dnd";import{NativeTypes as ot}from"react-dnd-html5-backend";import x from"prop-types";import Wo from"react";var et={};W(et,{isFolder:()=>M,moveFilesAndFolders:()=>Y});function M(t){return t.key.endsWith("/")}function Y(t,e,r){if(!e.didDrop())return;let o=e.getDropResult(),i=[],n=[];t.browserProps.selection.forEach(s=>{s[s.length-1]==="/"?i.push(s):n.push(s)}),t.browserProps.openFolder(o.path),i.forEach(s=>{let l=s,p=l.split("/"),u=p[p.length-2],c=`${o.path}${u}/`;c.substr(0,l.length)!==l&&c!==l&&t.browserProps.moveFolder&&t.browserProps.moveFolder(l,c)}),n.forEach(s=>{let l=s,p=l.split("/"),u=p[p.length-1],c=`${o.path}${u}`;c!==l&&t.browserProps.moveFile&&t.browserProps.moveFile(l,c)})}var Ko={Archive:["zip","rar","7z"],Audio:["mp3","ogg","wav","aac"],Excel:["xls","xlsx"],Image:["jpg","jpeg","png","bmp"],PDF:["pdf"],PowerPoint:["ppt","pptx"],Text:["txt"],Video:["mp4","flv","avi","wmv","mov"],Word:["doc","docx"],Code:["js"]},Oe={};for(let[t,e]of Object.entries(Ko))for(let r of e)Oe[r]=t;var Te=class extends Wo.Component{constructor(){super(...arguments);d(this,"state",{newName:this.getName()});d(this,"handleFileClick",e=>{e&&e.preventDefault(),this.props.browserProps.preview({url:this.props.url,name:this.getName(),key:this.props.fileKey,extension:this.getExtension()})});d(this,"handleItemClick",e=>{e.stopPropagation(),this.props.browserProps.select(this.props.fileKey,"file",e.ctrlKey||e.metaKey,e.shiftKey)});d(this,"handleItemDoubleClick",e=>{e.stopPropagation(),this.handleFileClick()});d(this,"handleRenameClick",e=>{!this.props.browserProps.renameFile||this.props.browserProps.beginAction("rename",this.props.fileKey)});d(this,"handleNewNameChange",e=>{let r=e.target.value;this.setState({newName:r})});d(this,"handleRenameSubmit",e=>{if(e&&e.preventDefault(),!this.props.browserProps.renameFile)return;let r=this.state.newName.trim();if(r.length===0||["/","\\"].some(s=>r.indexOf(s)!==-1))return;let i=r,n=this.props.fileKey.lastIndexOf("/");n!==-1&&(i=`${this.props.fileKey.substr(0,n)}/${r}`),this.props.browserProps.renameFile(this.props.fileKey,i)});d(this,"handleDeleteClick",e=>{!this.props.browserProps.deleteFile||this.props.browserProps.beginAction("delete",this.props.fileKey)});d(this,"handleDeleteSubmit",e=>{e.preventDefault(),!!this.props.browserProps.deleteFile&&this.props.browserProps.deleteFile(this.props.browserProps.actionTargets)});d(this,"handleCancelEdit",e=>{this.props.browserProps.endAction()})}selectFileNameFromRef(e){if(e){let r=e.value,o=r.lastIndexOf(".");e.setSelectionRange(0,o||r.length),e.focus()}}getName(){let e=this.props.newKey||this.props.fileKey,r=e.lastIndexOf("/");return r!==-1&&(e=e.substr(r+1)),e}getExtension(){let e=this.props.fileKey.split(".");return e[e.length-1].toLowerCase().trim()}getFileType(){return Oe[this.getExtension()]||"File"}connectDND(e){let r=this.props.isDragging||this.props.action;return typeof this.props.browserProps.moveFile=="function"&&!r&&!this.props.isRenaming&&(e=this.props.connectDragSource(e)),(typeof this.props.browserProps.createFiles=="function"||typeof this.props.browserProps.moveFile=="function"||typeof this.props.browserProps.moveFolder=="function")&&(e=this.props.connectDropTarget(e)),e}};d(Te,"propTypes",{fileKey:x.string,url:x.string,newKey:x.string,isRenaming:x.bool,connectDragSource:x.func,connectDropTarget:x.func,isDragging:x.bool,action:x.string,browserProps:x.shape({icons:x.object,select:x.func,beginAction:x.func,endAction:x.func,preview:x.func,createFiles:x.func,moveFile:x.func,moveFolder:x.func,renameFile:x.func,deleteFile:x.func})});var zo={beginDrag(t){return(!t.browserProps.selection.length||!t.browserProps.selection.includes(t.fileKey))&&t.browserProps.select(t.fileKey,"file"),{key:t.fileKey}},endDrag(t,e,r){Y(t,e,r)}};function Ro(t,e){return{connectDragPreview:t.dragPreview(),connectDragSource:t.dragSource(),isDragging:e.isDragging()}}var Go={drop(t,e){if(e.didDrop())return;let r=t.newKey||t.fileKey,o=r.lastIndexOf("/"),i=o!==-1?r.substr(0,o+1):"",n=e.getItem();return n.files&&t.browserProps.createFiles&&t.browserProps.createFiles(n.files,i),{path:i}}};function $o(t,e){return{connectDropTarget:t.dropTarget(),isOver:e.isOver({shallow:!0})}}var F={dragSource:zo,dragCollect:Ro,targetSource:Go,targetCollect:$o},J=Te;var se=class extends y.Component{handleHeaderClick(e){this.props.select(this.props.fileKey)}render(){let e=y.createElement("tr",{className:tt("folder",{dragover:this.props.isOver,selected:this.props.isSelected})},y.createElement("th",null,"File"),y.createElement("th",{className:"size"},"Size"),y.createElement("th",{className:"modified"},"Last Modified"));return typeof this.props.browserProps.createFiles=="function"||typeof this.props.browserProps.moveFile=="function"||typeof this.props.browserProps.moveFolder=="function"?this.props.connectDropTarget(e):e}};d(se,"propTypes",{select:B.func,fileKey:B.string,connectDropTarget:B.func,isOver:B.bool,isSelected:B.func,browserProps:B.shape({createFiles:B.func,moveFolder:B.func,moveFile:B.func,icons:B.shape({AscOrder:B.element,DescOrder:B.element})})});var Ho=rt(["file","folder",ot.FILE],F.targetSource,F.targetCollect)(se),it=class extends se{constructor(){super(...arguments);d(this,"state",{nameSortOrder:null,filenameSortOrder:null,sizeSortOrder:null,locationSortOrder:null,modifiedSortOrder:null})}getNewOrderState(e){let r=e+"SortOrder",o={nameSortOrder:null,filenameSortOrder:null,sizeSortOrder:null,modifiedSortOrder:null,locationSortOrder:null};return this.state[r]==="desc"?o[r]="asc":o[r]="desc",o}getOrderIcon(e){return this.state[e]==="desc"?this.props.browserProps.icons.DescOrder:this.state[e]==="asc"?this.props.browserProps.icons.AscOrder:null}handleHeaderClick(e){let r=this.getNewOrderState(e);this.props.handleChangeSort(e,r[e+"SortOrder"]),this.setState(r)}render(){let e=y.createElement("tr",{className:tt("folder",{dragover:this.props.isOver,selected:this.props.isSelected})},y.createElement("th",{className:"name"},y.createElement("span",{onClick:r=>{this.handleHeaderClick("name")}},"Name",y.createElement("span",null,this.getOrderIcon("nameSortOrder")))),y.createElement("th",{className:"filename"},y.createElement("span",{onClick:r=>{this.handleHeaderClick("filename")}},"Filename",y.createElement("span",null,this.getOrderIcon("filenameSortOrder")))),y.createElement("th",{className:"size"},y.createElement("span",{onClick:r=>{this.handleHeaderClick("size")}},"Size",y.createElement("span",null,this.getOrderIcon("sizeSortOrder")))),y.createElement("th",{className:"location"},y.createElement("span",{onClick:r=>{this.handleHeaderClick("location")}},"Location",y.createElement("span",null,this.getOrderIcon("locationSortOrder")))),y.createElement("th",{className:"modified"},y.createElement("span",{onClick:r=>{this.handleHeaderClick("modified")}},"Modified",y.createElement("span",null,this.getOrderIcon("modifiedSortOrder")))),y.createElement("th",{className:"actions"},"Actions"));return typeof this.props.browserProps.createFiles=="function"||typeof this.props.browserProps.moveFile=="function"||typeof this.props.browserProps.moveFolder=="function"?this.props.connectDropTarget(e):e}},Uo=rt(["file","folder",ot.FILE],F.targetSource,F.targetCollect)(it),le=Ho;var no={};W(no,{ListThumbnailFile:()=>we,RawListThumbnailFile:()=>Z,RawTableFile:()=>ee,SimpleListThumbnailFile:()=>eo,TableFile:()=>ye});var Vr=oe(V());import E from"react";import vs from"classnames";import{DragSource as Ds,DropTarget as Cs}from"react-dnd";import{NativeTypes as Ss}from"react-dnd-html5-backend";import{formatDistanceToNow as Ps}from"date-fns";function ys(t,e){if(t=parseFloat(t),isNaN(t))return parseFloat("0").toFixed(e);{let r=Math.pow(10,e);return t=(Math.round(t*r)/r).toFixed(e),t.toString()}}function Q(t){if(t>1024){let e=t/1024;if(e>1024){let r=e/1024;return`${ys(r,2)} MB`}return`${Math.round(e)} kB`}return`${t} B`}var Z=class extends J{render(){let{thumbnail_url:e,action:r,url:o,isDragging:i,isRenaming:n,isSelected:s,isSelectable:l,isOver:p,isDeleting:u,showName:c,showSize:A,showModified:T,browserProps:C,connectDragPreview:L}=this.props,q;e?q=E.createElement("div",{className:"image",style:{backgroundImage:"url("+e+")"}}):q=C.icons[this.getFileType()]||C.icons.File;let S=i||r,k=C.confirmDeletionRenderer,v;c&&(!S&&u&&C.selection.length===1?v=E.createElement(k,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:o},this.getName()):!S&&n?v=E.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},E.createElement("input",{ref:this.selectFileNameFromRef,type:"text",value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0})):v=E.createElement("a",{href:o,download:"download",onClick:this.handleFileClick},this.getName()));let b;A&&!n&&!u&&(b=E.createElement("span",{className:"size"},E.createElement("small",null,Q(this.props.size))));let K;T&&!n&&!u&&(K=E.createElement("span",{className:"modified"},"Last modified: ",Ps(this.props.modified,{addSuffix:!0})));let P={};l&&(P={onClick:this.handleItemClick});let R=E.createElement("li",m({className:vs("file",{pending:r,dragging:i,dragover:p,selected:s}),onDoubleClick:this.handleItemDoubleClick},P),E.createElement("div",{className:"item"},E.createElement("span",{className:"thumb"},q),E.createElement("span",{className:"name"},v),b,K));return typeof C.moveFile=="function"&&(R=L(R)),this.connectDND(R)}};d(Z,"defaultProps",{showName:!0,showSize:!0,showModified:!0,isSelectable:!0});var xs=(0,Vr.default)(Ds("file",F.dragSource,F.dragCollect),Cs(["file","folder",Ss.FILE],F.targetSource,F.targetCollect))(Z),we=xs;import Qr from"react";var Zr=class extends Qr.Component{render(){return Qr.createElement(we,D(m({},this.props),{showName:!1,showSize:!1,showModified:!1,isSelectable:!1}))}},eo=Zr;var We=oe(V());import O from"react";import Ns from"classnames";import{DragSource as to,DropTarget as ro}from"react-dnd";import{NativeTypes as oo}from"react-dnd-html5-backend";import{formatDistanceToNow as _s}from"date-fns";import N from"react";import _ from"prop-types";var Ee=t=>{let{selectedItems:e,isFolder:r,icons:o,nameFilter:i,canCreateFolder:n,onCreateFolder:s,canRenameFile:l,onRenameFile:p,canRenameFolder:u,onRenameFolder:c,canDeleteFile:A,onDeleteFile:T,canDeleteFolder:C,onDeleteFolder:L,canDownloadFile:q,onDownloadFile:S,canDownloadFolder:k,onDownloadFolder:v}=t,b=[];if(e.length){let K=e.filter(P=>P.action);if(K.length===e.length&&[...new Set(K)].length===1){let P;switch(K[0].action){case"delete":P="Deleting ...";break;case"rename":P="Renaming ...";break;default:P="Moving ...";break}b=N.createElement("div",{className:"item-actions"},o.Loading," ",P)}else{r&&n&&!i&&b.push(N.createElement("li",{key:"action-add-folder"},N.createElement("a",{onClick:s,href:"#",role:"button"},o.Folder,"\xA0Add Subfolder")));let P=e.find(R=>!R.keyDerived);!P&&!r&&l&&e.length===1?b.push(N.createElement("li",{key:"action-rename"},N.createElement("a",{onClick:p,href:"#",role:"button"},o.Rename,"\xA0Rename"))):!P&&r&&u&&b.push(N.createElement("li",{key:"action-rename"},N.createElement("a",{onClick:c,href:"#",role:"button"},o.Rename,"\xA0Rename"))),!P&&!r&&A?b.push(N.createElement("li",{key:"action-delete"},N.createElement("a",{onClick:T,href:"#",role:"button"},o.Delete,"\xA0Delete"))):!P&&r&&C&&b.push(N.createElement("li",{key:"action-delete"},N.createElement("a",{onClick:L,href:"#",role:"button"},o.Delete,"\xA0Delete"))),(!r&&q||r&&k)&&b.push(N.createElement("li",{key:"action-download"},N.createElement("a",{onClick:r?v:S,href:"#",role:"button"},o.Download,"\xA0Download"))),b.length?b=N.createElement("ul",{className:"item-actions"},b):b=N.createElement("div",{className:"item-actions"},"\xA0")}}else n&&!i&&b.push(N.createElement("li",{key:"action-add-folder"},N.createElement("a",{onClick:s,href:"#",role:"button"},o.Folder,"\xA0Add Folder"))),b.length?b=N.createElement("ul",{className:"item-actions"},b):b=N.createElement("div",{className:"item-actions"},"\xA0");return b};Ee.propTypes={selectedItems:_.arrayOf(_.object),isFolder:_.bool,icons:_.object,nameFilter:_.string,canCreateFolder:_.bool,onCreateFolder:_.func,canRenameFile:_.bool,onRenameFile:_.func,canRenameFolder:_.bool,onRenameFolder:_.func,canDeleteFile:_.bool,onDeleteFile:_.func,canDeleteFolder:_.bool,onDeleteFolder:_.func,canDownloadFile:_.bool,onDownloadFile:_.func,canDownloadFolder:_.bool,onDownloadFolder:_.func};Ee.defaultProps={selectedItems:[],isFolder:!1,icons:{},nameFilter:"",canCreateFolder:!1,onCreateFolder:null,canRenameFile:!1,onRenameFile:null,canRenameFolder:!1,onRenameFolder:null,canDeleteFile:!1,onDeleteFile:null,canDeleteFolder:!1,onDeleteFolder:null,canDownloadFile:!1,onDownloadFile:null,canDownloadFolder:!1,onDownloadFolder:null};var Ke=Ee;var ee=class extends J{render(){let{isDragging:e,isDeleting:r,isRenaming:o,isOver:i,isSelected:n,action:s,url:l,browserProps:p,connectDragPreview:u,depth:c,size:A,modified:T}=this.props,C=p.icons[this.getFileType()]||p.icons.File,L=e||s,q=p.confirmDeletionRenderer,S;!L&&r&&p.selection.length===1?S=O.createElement(q,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:l},C,this.getName()):!L&&o?S=O.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},C,O.createElement("input",{ref:this.selectFileNameFromRef,type:"text",value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0})):S=O.createElement("a",{href:l||"#",download:"download",onClick:this.handleFileClick},C,this.getName());let k=O.createElement("div",null,S);typeof p.moveFile=="function"&&(k=u(k));let v=O.createElement("tr",{className:Ns("file",{pending:s,dragging:e,dragover:i,selected:n}),onClick:this.handleItemClick,onDoubleClick:this.handleItemDoubleClick},O.createElement("td",{className:"name"},O.createElement("div",{style:{paddingLeft:c*16+"px"}},k)),O.createElement("td",{className:"size"},Q(A)),O.createElement("td",{className:"modified"},typeof T=="undefined"?"-":_s(T,{addSuffix:!0})));return this.connectDND(v)}},ks=(0,We.default)(to("file",F.dragSource,F.dragCollect),ro(["file","folder",oo.FILE],F.targetSource,F.targetCollect))(ee),io=class extends ee{render(){let{browserProps:e,size:r}=this.props,o=O.createElement("tr",null,O.createElement("td",{className:"name"},this.props.name),O.createElement("td",{className:"filename"},this.props.filename),O.createElement("td",{className:"size"},Q(r)),O.createElement("td",{className:"location"},this.props.location),O.createElement("td",{className:"modified"},this.props.modified),O.createElement("td",{className:"actions"},O.createElement("a",{onClick:i=>{i.preventDefault(),i.stopPropagation(),this.props.onDownloadFile([this.props.fileKey])},href:"#",role:"button"},e.icons.Download,"Download")));return this.connectDND(o)}},Os=(0,We.default)(to("file",F.dragSource,F.dragCollect),ro(["file","folder",oo.FILE],F.targetSource,F.targetCollect))(io),ye=ks;var po={};W(po,{ListThumbnailFolder:()=>lo,RawListThumbnailFolder:()=>ve,RawTableFolder:()=>De,TableFolder:()=>Ce});var so=oe(V());import I from"react";import qs from"classnames";import{DragSource as Is,DropTarget as Ls}from"react-dnd";import{NativeTypes as Ms}from"react-dnd-html5-backend";import w from"prop-types";import Ts from"react";var ze=class extends Ts.Component{constructor(){super(...arguments);d(this,"state",{newName:this.props.isDraft?"New folder":this.getName()});d(this,"handleFolderClick",e=>{e.stopPropagation(),this.props.browserProps.select(this.props.fileKey,"folder",e.ctrlKey||e.metaKey,e.shiftKey)});d(this,"handleFolderDoubleClick",e=>{e.stopPropagation(),this.toggleFolder()});d(this,"handleRenameClick",e=>{!this.props.browserProps.renameFolder||this.props.browserProps.beginAction("rename",this.props.fileKey)});d(this,"handleNewNameChange",e=>{let r=e.target.value;this.setState({newName:r})});d(this,"handleRenameSubmit",e=>{if(e.preventDefault(),!this.props.browserProps.renameFolder&&!this.props.isDraft)return;let r=this.state.newName.trim();if(r.length===0||["/","\\"].some(n=>r.indexOf(n)!==-1))return;let i=this.props.fileKey.substr(0,this.props.fileKey.substr(0,this.props.fileKey.length-1).lastIndexOf("/"));i.length&&(i+="/"),i+=r,i+="/",this.props.isDraft?this.props.browserProps.createFolder(i):this.props.browserProps.renameFolder(this.props.fileKey,i)});d(this,"handleDeleteClick",e=>{!this.props.browserProps.deleteFolder||this.props.browserProps.beginAction("delete",this.props.fileKey)});d(this,"handleDeleteSubmit",e=>{e.preventDefault(),!!this.props.browserProps.deleteFolder&&this.props.browserProps.deleteFolder(this.props.browserProps.actionTargets)});d(this,"handleCancelEdit",e=>{this.props.browserProps.endAction()});d(this,"toggleFolder",()=>{this.props.browserProps.toggleFolder(this.props.fileKey)})}selectFolderNameFromRef(e){if(e){let r=e.value;e.setSelectionRange(0,r.length),e.focus()}}getName(){if(this.props.name)return this.props.name;let e=this.props.fileKey.split("/");return this.props.newName||e[e.length-2]}connectDND(e){let r=this.props.isDragging||this.props.action;return this.props.keyDerived&&(typeof this.props.browserProps.moveFolder=="function"&&!r&&!this.props.isRenaming&&!this.props.isDeleting&&(e=this.props.connectDragSource(e)),(typeof this.props.browserProps.createFiles=="function"||typeof this.props.browserProps.moveFolder=="function"||typeof this.props.browserProps.moveFile=="function")&&(e=this.props.connectDropTarget(e))),e}};d(ze,"propTypes",{name:w.string,fileKey:w.string,newName:w.string,keyDerived:w.bool,isDraft:w.bool,isRenaming:w.bool,isDeleting:w.bool,connectDragSource:w.func,connectDropTarget:w.func,isDragging:w.bool,action:w.string,browserProps:w.shape({select:w.func,toggleFolder:w.func,beginAction:w.func,endAction:w.func,preview:w.func,createFiles:w.func,createFolder:w.func,moveFile:w.func,moveFolder:w.func,renameFolder:w.func,deleteFolder:w.func})});var As={beginDrag(t){return t.browserProps.selection.length||t.browserProps.select(t.fileKey,"folder"),{key:t.fileKey}},endDrag(t,e,r){Y(t,e,r)}};function js(t,e){return{connectDragPreview:t.dragPreview(),connectDragSource:t.dragSource(),isDragging:e.isDragging()}}var G={dragSource:As,dragCollect:js},te=ze;var ve=class extends te{render(){let{isOpen:e,isDragging:r,isDeleting:o,isRenaming:i,isDraft:n,isOver:s,isSelected:l,url:p,action:u,browserProps:c,depth:A,keyDerived:T,connectDragPreview:C}=this.props,L=c.icons[e?"FolderOpen":"Folder"],q=r||u,S=c.confirmDeletionRenderer,k;!q&&o&&c.selection.length===1?k=I.createElement(S,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:p},this.getName()):!q&&i||n?k=I.createElement("div",null,I.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},I.createElement("input",{type:"text",ref:this.selectFolderNameFromRef,value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0}))):k=I.createElement("div",null,I.createElement("a",{onClick:this.toggleFolder},this.getName()));let v;if(e&&c.nestChildren){v=[];for(let K=0;K<v.length;K++){let P=v[K],R=D(m({},c.getItemProps(P,c)),{depth:A+1});M(P)?v.push(I.createElement(c.folderRenderer,m(D(m(m({},P),R),{browserProps:c}),c.folderRendererProps))):v.push(I.createElement(c.fileRenderer,m(D(m(m({},P),R),{browserProps:c}),c.fileRendererProps)))}v.length?v=I.createElement("ul",{style:{padding:"0 8px",paddingLeft:"16px"}},v):v=I.createElement("p",null,"No items in this folder")}let b=I.createElement("li",{className:qs("folder",{expanded:e&&c.nestChildren,pending:u,dragging:r,dragover:s,selected:l}),onClick:this.handleFolderClick,onDoubleClick:this.handleFolderDoubleClick},I.createElement("div",{className:"item"},I.createElement("span",{className:"thumb"},L),I.createElement("span",{className:"name"},k)),v);return typeof c.moveFolder=="function"&&T&&(b=C(b)),this.connectDND(b)}},Bs=(0,so.default)(Is("folder",G.dragSource,G.dragCollect),Ls(["file","folder",Ms.FILE],F.targetSource,F.targetCollect))(ve),lo=Bs;var ao=oe(V());import j from"react";import Es from"classnames";import{DragSource as Ks,DropTarget as Ws}from"react-dnd";import{NativeTypes as zs}from"react-dnd-html5-backend";var De=class extends te{render(){let{isOpen:e,isDragging:r,isDeleting:o,isRenaming:i,isDraft:n,isOver:s,isSelected:l,action:p,url:u,browserProps:c,connectDragPreview:A,depth:T}=this.props,C=c.icons[e?"FolderOpen":"Folder"],L=r||p,q=c.confirmDeletionRenderer,S;!L&&o&&c.selection.length===1?S=j.createElement(q,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:u},C,this.getName()):!L&&i||n?S=j.createElement("div",null,j.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},C,j.createElement("input",{type:"text",ref:this.selectFolderNameFromRef,value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0}))):S=j.createElement("div",null,j.createElement("a",{onClick:this.toggleFolder},C,this.getName()));let k=j.createElement("div",null,S);typeof c.moveFile=="function"&&(k=A(k));let v=j.createElement("tr",{className:Es("folder",{pending:p,dragging:r,dragover:s,selected:l}),onClick:this.handleFolderClick,onDoubleClick:this.handleFolderDoubleClick},j.createElement("td",{className:"name"},j.createElement("div",{style:{paddingLeft:T*16+"px"}},k)),j.createElement("td",null),j.createElement("td",null),j.createElement("td",null),j.createElement("td",null),j.createElement("td",null));return this.connectDND(v)}},Rs=(0,ao.default)(Ks("folder",G.dragSource,G.dragCollect),Ws(["file","folder",zs.FILE],F.targetSource,F.targetCollect))(De),Ce=Rs;import Se from"react";import Pe from"prop-types";var Re=t=>{let{children:e,handleDeleteSubmit:r,handleFileClick:o,url:i}=t;return Se.createElement("form",{className:"deleting",onSubmit:r},Se.createElement("a",{href:i,download:"download",onClick:o},e),Se.createElement("div",null,Se.createElement("button",{type:"submit"},"Confirm Deletion")))};Re.propTypes={children:Pe.node,handleDeleteSubmit:Pe.func,handleFileClick:Pe.func,url:Pe.string};Re.defaultProps={url:"#"};var Ge=Re;import Gs from"react";import $s from"prop-types";var co=t=>{let{handleDeleteSubmit:e}=t;return Gs.createElement("button",{className:"deleting",onClick:e},"Confirm Deletion")};co.propTypes={handleDeleteSubmit:$s.func};var $e=co;var wo={};W(wo,{FlatGrouper:()=>bo,GroupByFolder:()=>xe,GroupByModifiedRelative:()=>Fo});function xe(t,e){let r={contents:[],children:{}};t.map(i=>{i.relativeKey=(i.newKey||i.key).substr(e.length);let n=r,s=i.relativeKey.split("/");s.map((l,p)=>{if(p===s.length-1&&M(i))for(let c in i)n[c]=i[c];if(l==="")return;!M(i)&&p===s.length-1?n.contents.push(D(m({},i),{keyDerived:!0})):(l in n.children||(n.children[l]={contents:[],children:{}}),n=n.children[l])})});function o(i,n){n!==""&&(n+="/");let s=[];for(let l in i.children)s.push(D(m({},i.children[l]),{contents:void 0,keyDerived:!0,key:e+n+l+"/",relativeKey:n+l+"/",children:o(i.children[l],n+l),size:0}));return s=s.concat(i.contents),s}return t=o(r,""),t}import{format as Qs,startOfMonth as Zs,endOfMonth as el}from"date-fns";import{startOfToday as Hs,endOfToday as Us,startOfYesterday as Ys,endOfYesterday as Js,startOfWeek as fo,endOfWeek as ho,addWeeks as uo,startOfMonth as Xs,endOfMonth as Vs,getMonth as mo}from"date-fns";function go(){let t=[],e=new Date;return t.push({name:"Today",begins:Hs(),ends:Us(),items:[]}),t.push({name:"Yesterday",begins:Ys(),ends:Js(),items:[]}),t.push({name:"Earlier this Week",begins:fo(e),ends:ho(e),items:[]}),t.push({name:"Last Week",begins:fo(uo(e,-1)),ends:ho(uo(e,-1)),items:[]}),mo(t[t.length-1].begins)===mo(e)&&t.push({name:"Earlier this Month",begins:Xs(e),ends:Vs(e),items:[]}),t}function Fo(t,e){let r=go();for(let i=0;i<t.length;i++){let n=t[i];if(M(n))continue;let s=D(m({},n),{keyDerived:!0}),l=!1,p=+s.modified;for(let u=0;u<r.length;u++){let c=r[u];if(p>+c.begins&&p<=+c.ends){c.items.push(s),l=!0;break}}if(!l){let u={name:Qs(s.modified,"MMMM yyyy"),begins:Zs(s.modified),ends:el(s.modified),items:[]};u.items.push(s),r.push(u)}}let o=[];for(let i=0;i<r.length;i++){let n=r[i];!n.items.length||o.push({key:`${n.name.toLowerCase().replace(" ","_")}/`,name:n.name,children:n.items,size:0})}return o}function bo(t,e){return t}var Po={};W(Po,{SortByModified:()=>So,SortByName:()=>Do,SortByProp:()=>H});var yo=/(-?\d*\.?\d+)/g;function He(t,e){let r=String(t.name).split(yo),o=String(e.name).split(yo),i=Math.min(r.length,o.length);for(let n=0;n<i;n++){let s=parseFloat(r[n])||r[n].toLowerCase(),l=parseFloat(o[n])||o[n].toLowerCase();if(s<l)return-1;if(s>l)return 1}return 0}function tl(t,e){return t.draft&&!e.draft?1:e.draft&&!t.draft?-1:He(t,e)}function vo(t){let e=[],r=[];for(let i=0;i<t.length;i++){let n=t[i],s=(n.newKey||n.key).split("/");n.children?(n.name||(n.name=s[s.length-2]),e.push(n)):(n.name||(n.name=s[s.length-1]),r.push(n))}r=r.sort(He),e=e.sort(tl);for(let i=0;i<e.length;i++){let n=e[i];n.children=vo(n.children)}let o=[];return o=o.concat(e),o=o.concat(r),o}function Do(t){return vo(t)}import{compareAsc as rl}from"date-fns";function Co(t){let e=[],r=[];for(let i=0;i<t.length;i++){let n=t[i],s=(n.newKey||n.key).split("/");n.children?e.push(n):(n.name=s[s.length-1],r.push(n))}r=r.sort(rl);for(let i=0;i<e.length;i++){let n=e[i];n.children=Co(n.children)}let o=[];return o=o.concat(e),o=o.concat(r),o}function So(t){return Co(t)}function H(t,e,r){let o=[],i=[];for(let s=0;s<t.length;s++){let l=t[s],p=(l.newKey||l.key).split("/");l.children?(l.name||(l.name=p[p.length-2]),o.push(l)):(l.name||(l.name=p[p.length-1]),i.push(l))}i=i.sort((s,l)=>{if(r==="desc")return s[e]>l[e]?1:s[e]<l[e]?-1:0;if(r==="asc")return s[e]>l[e]?-1:s[e]<l[e]?1:0}),o=o.sort((s,l)=>{if(r==="desc")return s[e]>l[e]?1:s[e]<l[e]?-1:0;if(r==="asc")return s[e]>l[e]?-1:s[e]<l[e]?1:0});for(let s=0;s<o.length;s++){let l=o[s];l.children=H(l.children,e,r)}let n=[];return n=n.concat(o),n=n.concat(i),n}var Ue=20,sl=/.*\/__new__[/]?$/gm;function ll(t,e){return{key:`file-${t.key}`,fileKey:t.key,isSelected:e.selection.includes(t.key),isOpen:t.key in e.openFolders||e.nameFilter,isRenaming:e.activeAction==="rename"&&e.actionTargets.includes(t.key),isDeleting:e.activeAction==="delete"&&e.actionTargets.includes(t.key),isDraft:!!t.draft}}var re=class extends h.Component{constructor(){super(...arguments);d(this,"state",{openFolders:{},selection:[],activeAction:null,actionTargets:[],nameFilter:"",searchResultsShown:Ue,previewFile:null,addFolder:null,sortByProp:null,sortOrder:"asc"});d(this,"getFile",e=>{let r=!1,o=this.props.files.find(i=>(i.key.startsWith(e)&&(r=!0),i.key===e));if(o)return o;if(r)return{key:e,modified:0,size:0,relativeKey:e}});d(this,"createFiles",(e,r)=>{this.setState(o=>{let i={selection:[]};return r&&(i.openFolders=D(m({},o.openFolders),{[r]:!0})),i},()=>{this.props.onCreateFiles(e,r)})});d(this,"createFolder",e=>{this.setState({activeAction:null,actionTargets:[],selection:[e]},()=>{this.props.onCreateFolder(e)})});d(this,"moveFile",(e,r)=>{this.setState({activeAction:null,actionTargets:[],selection:[r]},()=>{this.props.onMoveFile(e,r)})});d(this,"moveFolder",(e,r)=>{this.setState(o=>{let i={activeAction:null,actionTargets:[],selection:[r]};return e in o.openFolders&&(i.openFolders=D(m({},o.openFolders),{[r]:!0})),i},()=>{this.props.onMoveFolder(e,r)})});d(this,"renameFile",(e,r)=>{this.setState({activeAction:null,actionTargets:[],selection:[r]},()=>{this.props.onRenameFile(e,r)})});d(this,"renameFolder",(e,r)=>{this.setState(o=>{let i={activeAction:null,actionTargets:[]};return o.selection[0].substr(0,e.length)===e&&(i.selection=[o.selection[0].replace(e,r)]),e in o.openFolders&&(i.openFolders=D(m({},o.openFolders),{[r]:!0})),i},()=>{this.props.onRenameFolder(e,r)})});d(this,"deleteFile",e=>{this.setState({activeAction:null,actionTargets:[],selection:[]},()=>{this.props.onDeleteFile(e)})});d(this,"deleteFolder",e=>{this.setState(r=>{let o={activeAction:null,actionTargets:[],selection:[]};return e in r.openFolders&&(o.openFolders=m({},r.openFolders),delete o.openFolders[e]),o},()=>{this.props.onDeleteFolder(e)})});d(this,"downloadFile",e=>{this.setState({activeAction:null,actionTargets:[]},()=>{this.props.onDownloadFile(e)})});d(this,"downloadFolder",e=>{this.setState({activeAction:null,actionTargets:[]},()=>{this.props.onDownloadFolder(e)})});d(this,"beginAction",(e,r)=>{this.setState({activeAction:e,actionTargets:r||[]})});d(this,"endAction",()=>{this.state.selection&&this.state.selection.length>0&&this.state.selection.filter(e=>e.match(sl)).length>0&&this.setState({selection:[]}),this.beginAction(null,null)});d(this,"select",(e,r,o,i)=>{let{actionTargets:n}=this.state,s=n.length&&!n.includes(e),l=this.getFile(e),p=[e];if(o||i){let u=this.state.selection.indexOf(e);u!==-1?p=[...this.state.selection.slice(0,u),...this.state.selection.slice(u+1)]:p=[...this.state.selection,e]}this.setState(u=>({selection:p,actionTargets:s?[]:n,activeAction:s?null:u.activeAction}),()=>{this.props.onSelect(l),r==="file"&&this.props.onSelectFile(l),r==="folder"&&this.props.onSelectFolder(l)})});d(this,"preview",e=>{this.state.previewFile&&this.state.previewFile.key!==e.key&&this.closeDetail(),this.setState({previewFile:e},()=>{this.props.onPreviewOpen(e)})});d(this,"closeDetail",()=>{this.setState({previewFile:null},()=>{this.props.onPreviewClose(this.state.previewFile)})});d(this,"handleShowMoreClick",e=>{e.preventDefault(),this.setState(r=>({searchResultsShown:r.searchResultsShown+Ue}))});d(this,"toggleFolder",e=>{let r=e in this.state.openFolders;this.setState(o=>{let i={openFolders:m({},o.openFolders)};return r?delete i.openFolders[e]:i.openFolders[e]=!0,i},()=>{let o=r?"onFolderClose":"onFolderOpen";this.props[o](this.getFile(e))})});d(this,"openFolder",e=>{this.setState(r=>({openFolders:D(m({},r.openFolders),{[e]:!0})}),()=>{this.props.onFolderOpen(this.getFile(e))})});d(this,"handleGlobalClick",e=>{!!(this.browserRef&&this.browserRef.contains(e.target))||this.setState({selection:[],actionTargets:[],activeAction:null})});d(this,"handleActionBarRenameClick",e=>{e.preventDefault(),this.beginAction("rename",this.state.selection)});d(this,"handleActionBarDeleteClick",e=>{e.preventDefault(),this.beginAction("delete",this.state.selection)});d(this,"handleActionBarAddFolderClick",e=>{e.preventDefault(),this.state.activeAction!=="createFolder"&&this.setState(r=>{let o="";r.selection&&r.selection.length>0&&(o+=r.selection,o.substr(o.length-1,o.length)!=="/"&&(o+="/")),o!=="__new__/"&&!o.endsWith("/__new__/")&&(o+="__new__/");let i={actionTargets:[o],activeAction:"createFolder",selection:[o]};return r.selection&&r.selection.length>0&&(i.openFolders=D(m({},r.openFolders),{[this.state.selection]:!0})),i})});d(this,"handleActionBarDownloadClick",e=>{e.preventDefault();let r=this.getFiles(),o=this.getSelectedItems(r);if(o.length===1&&M(o[0])){this.downloadFolder(this.state.selection);return}this.downloadFile(this.state.selection)});d(this,"updateFilter",e=>{this.setState({nameFilter:e,searchResultsShown:Ue})});d(this,"handleMultipleDeleteSubmit",()=>{console.log(this),this.deleteFolder(this.state.selection.filter(e=>e[e.length-1]==="/")),this.deleteFile(this.state.selection.filter(e=>e[e.length-1]!=="/"))});d(this,"changeSort",(e,r)=>{this.setState({sortByProp:e,sortOrder:r})});d(this,"renderContent",{table:(e,r,o)=>this.renderTable(e,r,o),list:(e,r,o)=>this.renderList(e,r,o),separate:(e,r,o)=>this.renderSeparate(e,r,o)})}componentDidMount(){this.props.renderStyle==="table"&&this.props.nestChildren&&console.warn("Invalid settings: Cannot nest table children in file browser"),window.addEventListener("click",this.handleGlobalClick)}componentWillUnmount(){window.removeEventListener("click",this.handleGlobalClick)}getBrowserProps(){return{nestChildren:this.props.nestChildren,fileRenderer:this.props.fileRenderer,fileRendererProps:this.props.fileRendererProps,folderRenderer:this.props.folderRenderer,folderRendererProps:this.props.folderRendererProps,confirmDeletionRenderer:this.props.confirmDeletionRenderer,confirmMultipleDeletionRenderer:this.props.confirmMultipleDeletionRenderer,icons:this.props.icons,openFolders:this.state.openFolders,nameFilter:this.state.nameFilter,selection:this.state.selection,activeAction:this.state.activeAction,actionTargets:this.state.actionTargets,select:this.select,openFolder:this.openFolder,toggleFolder:this.toggleFolder,beginAction:this.beginAction,endAction:this.endAction,preview:this.preview,createFiles:this.props.onCreateFiles?this.createFiles:void 0,createFolder:this.props.onCreateFolder?this.createFolder:void 0,renameFile:this.props.onRenameFile?this.renameFile:void 0,renameFolder:this.props.onRenameFolder?this.renameFolder:void 0,moveFile:this.props.onMoveFile?this.moveFile:void 0,moveFolder:this.props.onMoveFolder?this.moveFolder:void 0,deleteFile:this.props.onDeleteFile?this.deleteFile:void 0,deleteFolder:this.props.onDeleteFolder?this.deleteFolder:void 0,getItemProps:ll}}renderActionBar(e){let{icons:r,canFilter:o,filterRendererProps:i,filterRenderer:n,actionRenderer:s,onCreateFolder:l,onRenameFile:p,onRenameFolder:u,onDeleteFile:c,onDeleteFolder:A,onDownloadFile:T,onDownloadFolder:C}=this.props,L=this.getBrowserProps(),q=e.length===1&&M(e[0]),S;o&&(S=h.createElement(n,m({value:this.state.nameFilter,updateFilter:this.updateFilter},i)));let k=h.createElement(s,{browserProps:L,selectedItems:e,isFolder:q,icons:r,nameFilter:this.state.nameFilter,canCreateFolder:typeof l=="function",onCreateFolder:this.handleActionBarAddFolderClick,canRenameFile:typeof p=="function",onRenameFile:this.handleActionBarRenameClick,canRenameFolder:typeof u=="function",onRenameFolder:this.handleActionBarRenameClick,canDeleteFile:typeof c=="function",onDeleteFile:this.handleActionBarDeleteClick,canDeleteFolder:typeof A=="function",onDeleteFolder:this.handleActionBarDeleteClick,canDownloadFile:typeof T=="function",onDownloadFile:this.handleActionBarDownloadClick,canDownloadFolder:typeof C=="function",onDownloadFolder:this.handleActionBarDownloadClick});return h.createElement("div",{className:"action-bar"},S,k)}renderFiles(e,r){let{fileRenderer:o,fileRendererProps:i,folderRenderer:n,folderRendererProps:s}=this.props,l=this.getBrowserProps(),p=[];return e.map(u=>{let c=D(m({},l.getItemProps(u,l)),{depth:this.state.nameFilter?0:r});M(u)?((this.props.showFoldersOnFilter||!this.state.nameFilter)&&p.push(h.createElement(n,m(D(m(m({},u),c),{browserProps:l}),s))),(this.state.nameFilter||c.isOpen&&!l.nestChildren)&&(p=p.concat(this.renderFiles(u.children,r+1)))):p.push(h.createElement(o,D(m(D(m(m({},u),c),{browserProps:l}),i),{onDownloadFile:this.props.onDownloadFile})))}),p}getFiles(){let e=this.props.files.concat([]);if(this.state.activeAction==="createFolder"&&e.push({key:this.state.actionTargets[0],size:0,draft:!0}),this.state.nameFilter){let r=[],o=this.state.nameFilter.toLowerCase().split(" ");e.map(i=>{let n=!1;o.map(s=>{i.key.toLowerCase().trim().indexOf(s)===-1&&(n=!0)}),!n&&r.push(i)}),e=r}if(typeof this.props.group=="function")e=this.props.group(e,"");else{let r=[];e.map(o=>{M(o)||r.push(o)}),e=r}return typeof this.props.sort=="function"&&(e=this.props.sort(e,this.state.sortByProp,this.state.sortOrder)),e}getSelectedItems(e){let{selection:r}=this.state,o=[],i=n=>{r.includes(n.key)&&o.push(n),n.children&&n.children.map(i)};return e.map(i),o}renderTable(e,r,o){let i;if(!e.length)this.state.nameFilter?e=h.createElement("tr",null,h.createElement("td",{colSpan:100},'No files matching "',this.state.nameFilter,'".')):e=h.createElement("tr",null,h.createElement("td",{colSpan:100},this.props.noFilesMessage));else if(this.state.nameFilter){let n=e.length;e=e.slice(0,this.state.searchResultsShown),n>e.length&&e.push(h.createElement("tr",{key:"show-more"},h.createElement("td",{colSpan:100},h.createElement("a",{onClick:this.handleShowMoreClick,href:"#"},"Show more results"))))}return this.props.headerRenderer&&(r=h.createElement("thead",null,h.createElement(this.props.headerRenderer,m(m({},o),this.props.headerRendererProps)))),i=h.createElement("table",{cellSpacing:"0",cellPadding:"0"},r,h.createElement("tbody",null,e)),i}renderList(e,r,o){if(!e.length)this.state.nameFilter?e=h.createElement("p",{className:"empty"},'No files matching "',this.state.nameFilter,'"'):e=h.createElement("p",{className:"empty"},"No files.");else{let i;if(this.state.nameFilter){let n=e.length;e=e.slice(0,this.state.searchResultsShown),n>e.length&&(i=h.createElement("a",{onClick:this.handleShowMoreClick,href:"#"},"Show more results"))}e=h.createElement("div",null,h.createElement("ul",null,e),i)}return this.props.headerRenderer&&(r=h.createElement(this.props.headerRenderer,m(m({},o),this.props.headerRendererProps))),h.createElement("div",null,r,e)}renderSeparate(e,r,o){let i;if(!e.length)this.state.nameFilter?e=h.createElement("tr",null,h.createElement("td",{colSpan:100},'No files matching "',this.state.nameFilter,'".')):e=h.createElement("tr",null,h.createElement("td",{colSpan:100},this.props.noFilesMessage));else if(this.state.nameFilter){let l=e.length;e=e.slice(0,this.state.searchResultsShown),l>e.length&&e.push(h.createElement("tr",{key:"show-more"},h.createElement("td",{colSpan:100},h.createElement("a",{onClick:this.handleShowMoreClick,href:"#"},"Show more results"))))}this.props.headerRenderer&&(r=h.createElement("thead",null,h.createElement(this.props.headerRenderer,m(m({},o),this.props.headerRendererProps))));let n=e.filter(l=>l.type===this.props.folderRenderer),s=e.filter(l=>l.type===this.props.fileRenderer);return i=h.createElement("div",null,h.createElement("table",{cellSpacing:"0",cellPadding:"0"},h.createElement("tbody",null,n)),h.createElement("table",{cellSpacing:"0",cellPadding:"0"},r,h.createElement("tbody",null,s))),i}render(){let r={browserProps:this.getBrowserProps(),fileKey:"",fileCount:this.props.files.length,handleChangeSort:this.changeSort},o,i=this.getFiles(),n=this.getSelectedItems(i),s,l=this.renderFiles(i,0);o=this.renderContent[this.props.renderStyle](l,s,r);let p=this.props.confirmMultipleDeletionRenderer;return h.createElement("div",{className:"rendered-react-keyed-file-browser"},this.props.actions,h.createElement("div",{className:"rendered-file-browser",ref:u=>{this.browserRef=u}},this.props.showActionBar&&this.renderActionBar(n),this.state.activeAction==="delete"&&this.state.selection.length>1&&h.createElement(p,{handleDeleteSubmit:this.handleMultipleDeleteSubmit}),h.createElement("div",{className:"files"},o)),this.state.previewFile!==null&&h.createElement(this.props.detailRenderer,m({file:this.state.previewFile,close:this.closeDetail},this.props.detailRendererProps)))}};d(re,"propTypes",{files:a.arrayOf(a.shape({key:a.string.isRequired,modified:a.number,size:a.number})).isRequired,actions:a.node,showActionBar:a.bool.isRequired,canFilter:a.bool.isRequired,showFoldersOnFilter:a.bool,noFilesMessage:a.string,group:a.func.isRequired,sort:a.func.isRequired,icons:a.shape({Folder:a.element,FolderOpen:a.element,File:a.element,PDF:a.element,Image:a.element,Delete:a.element,Rename:a.element,Loading:a.element,Download:a.element,AscOrder:a.element,DescOrder:a.element}),nestChildren:a.bool.isRequired,renderStyle:a.oneOf(["list","table","separate"]).isRequired,startOpen:a.bool.isRequired,headerRenderer:a.func,headerRendererProps:a.object,filterRenderer:a.func,filterRendererProps:a.object,fileRenderer:a.func,fileRendererProps:a.object,folderRenderer:a.func,folderRendererProps:a.object,detailRenderer:a.func,detailRendererProps:a.object,actionRenderer:a.func,confirmDeletionRenderer:a.func,confirmMultipleDeletionRenderer:a.func,onCreateFiles:a.oneOfType([a.func,a.bool]),onCreateFolder:a.oneOfType([a.func,a.bool]),onMoveFile:a.oneOfType([a.func,a.bool]),onMoveFolder:a.oneOfType([a.func,a.bool]),onRenameFile:a.oneOfType([a.func,a.bool]),onRenameFolder:a.oneOfType([a.func,a.bool]),onDeleteFile:a.oneOfType([a.func,a.bool]),onDeleteFolder:a.oneOfType([a.func,a.bool]),onDownloadFile:a.oneOfType([a.func,a.bool]),onDownloadFolder:a.oneOfType([a.func,a.bool]),onSelect:a.func,onSelectFile:a.func,onSelectFolder:a.func,onPreviewOpen:a.func,onPreviewClose:a.func,onFolderOpen:a.func,onFolderClose:a.func,foldersHeader:a.string}),d(re,"defaultProps",{showActionBar:!0,canFilter:!0,showFoldersOnFilter:!1,noFilesMessage:"No files.",group:xe,sort:H,nestChildren:!1,renderStyle:"table",startOpen:!1,headerRenderer:le,headerRendererProps:{},filterRenderer:ne,filterRendererProps:{},fileRenderer:ye,fileRendererProps:{},folderRenderer:Ce,folderRendererProps:{},detailRenderer:ie,detailRendererProps:{},actionRenderer:Ke,confirmDeletionRenderer:Ge,confirmMultipleDeletionRenderer:$e,icons:{},onSelect:e=>{},onSelectFile:e=>{},onSelectFolder:e=>{},onPreviewOpen:e=>{},onPreviewClose:e=>{},onFolderOpen:e=>{},onFolderClose:e=>{}});var xo=class extends ol{render(){return h.createElement(il,{backend:nl},h.createElement(re,m({},this.props)))}},No=xo;var Oo={};W(Oo,{FontAwesome:()=>ko});import g from"react";var _o=t=>{let e=t===4?"fa":"fas",r=t===4?["FontAwesome",'"FontAwesome"']:['"Font Awesome 5 Free"','"Font Awesome 5 Pro"'],o=!1,i=document.createElement("span");i.className=e,i.style.display="none",document.body.insertBefore(i,document.body.firstChild);let n=(s,l)=>window.getComputedStyle(s,null).getPropertyValue(l);return r.includes(n(i,"font-family"))?o=!0:console.warn(`Font Awesome ${t} was not detected but Font Awesome ${t} icons have been requested for \`react-object-list\``),document.body.removeChild(i),o},al=(t=4)=>{switch(t){case 4:return _o(4),{File:g.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"}),Image:g.createElement("i",{className:"fa fa-file-image-o","aria-hidden":"true"}),Video:g.createElement("i",{className:"fa fa-file-video-o","aria-hidden":"true"}),Audio:g.createElement("i",{className:"fa fa-file-audio-o","aria-hidden":"true"}),Archive:g.createElement("i",{className:"fa fa-file-archive-o","aria-hidden":"true"}),Word:g.createElement("i",{className:"fa fa-file-word-o","aria-hidden":"true"}),Excel:g.createElement("i",{className:"fa fa-file-excel-o","aria-hidden":"true"}),PowerPoint:g.createElement("i",{className:"fa fa-file-powerpoint-o","aria-hidden":"true"}),Text:g.createElement("i",{className:"fa fa-file-text-o","aria-hidden":"true"}),PDF:g.createElement("i",{className:"fa fa-file-pdf-o","aria-hidden":"true"}),Rename:g.createElement("i",{className:"fa fa-i-cursor","aria-hidden":"true"}),Folder:g.createElement("i",{className:"fa fa-folder-o","aria-hidden":"true"}),FolderOpen:g.createElement("i",{className:"fa fa-folder-open-o","aria-hidden":"true"}),Delete:g.createElement("i",{className:"fa fa-trash-o","aria-hidden":"true"}),Loading:g.createElement("i",{className:"fa fa-circle-o-notch fa-spin","aria-hidden":"true"}),Download:g.createElement("i",{className:"fa fa-download","aria-hidden":"true"})};case 5:return _o(5),{File:g.createElement("i",{className:"far fa-file","aria-hidden":"true"}),Image:g.createElement("i",{className:"far fa-file-image","aria-hidden":"true"}),Video:g.createElement("i",{className:"far fa-file-video","aria-hidden":"true"}),Audio:g.createElement("i",{className:"far fa-file-audio","aria-hidden":"true"}),Archive:g.createElement("i",{className:"far fa-file-archive","aria-hidden":"true"}),Word:g.createElement("i",{className:"far fa-file-word","aria-hidden":"true"}),Excel:g.createElement("i",{className:"far fa-file-excel","aria-hidden":"true"}),PowerPoint:g.createElement("i",{className:"far fa-file-powerpoint","aria-hidden":"true"}),Text:g.createElement("i",{className:"far fa-file-alt","aria-hidden":"true"}),PDF:g.createElement("i",{className:"far fa-file-pdf","aria-hidden":"true"}),Rename:g.createElement("i",{className:"fas fa-i-cursor","aria-hidden":"true"}),Folder:g.createElement("i",{className:"far fa-folder","aria-hidden":"true"}),FolderOpen:g.createElement("i",{className:"far fa-folder-open","aria-hidden":"true"}),Delete:g.createElement("i",{className:"far fa-trash-alt","aria-hidden":"true"}),Loading:g.createElement("i",{className:"fas fa-circle-notch fa-spin","aria-hidden":"true"}),Download:g.createElement("i",{className:"fas fa-download","aria-hidden":"true"})};default:console.warn(`Could not find config for version ${t}`,"Accepted versions are: 4, 5","Please make an issue in `react-object-list` to fix this.")}},ko=al;var vp=No;export{J as BaseFile,F as BaseFileConnectors,te as BaseFolder,G as BaseFolderConnectors,Xe as Details,Os as ExtendedTableFile,Uo as ExtendedTableHeader,no as FileRenderers,Ze as Filters,po as FolderRenderers,wo as Groupers,nt as Headers,Oo as Icons,re as RawFileBrowser,Po as Sorters,et as Utils,vp as default};
//# sourceMappingURL=index.js.map
